sequenceDiagram
    autonumber
    actor User as User Agent<br/>(Browser)
    
    box "Presentation Tier (Port 8080)" #f4f4f4
        participant FC as FrontendController
        participant GW as EnergyGatewayService<br/>(RestClient)
        participant TPL as Thymeleaf Engine
    end

    box "Business & Data Tier (Port 8081)" #e1f5fe
        participant FAC as EnergyFacadeController<br/>(Remote Facade)
        participant SVC as EnergyAnalysisService<br/>(Business Logic)
        participant REPO as EnergyRepository<br/>(JPA)
        participant DB as H2 Database
    end

    Note over User, FC: User requests the Dashboard
    User->>FC: GET / (HTTP)
    
    activate FC
    FC->>GW: getFullReport()
    
    activate GW
    Note right of GW: Serialization to HTTP Request
    GW->>FAC: GET /app/facade/full-report
    
    %% NETWORK BOUNDARY
    Note over GW, FAC: ðŸŒ Network Boundary (JSON over HTTP)
    
    activate FAC
    FAC->>SVC: generateFullReport()
    
    activate SVC
    SVC->>REPO: findAll() / findTop100()
    activate REPO
    REPO->>DB: SELECT * FROM energy_readings
    activate DB
    DB-->>REPO: ResultSet (Rows)
    deactivate DB
    REPO-->>SVC: List<EnergyReading> (Entities)
    deactivate REPO
    
    Note right of SVC: Data Aggregation &<br/>DTO Mapping
    SVC-->>FAC: SystemReportDTO (Coarse-Grained)
    deactivate SVC
    
    FAC-->>GW: 200 OK (JSON Payload)
    deactivate FAC
    
    Note left of GW: Deserialization to Java Objects
    GW-->>FC: SystemReportDTO
    deactivate GW
    
    FC->>TPL: Process Template (dashboard.html + DTO)
    activate TPL
    TPL-->>FC: Rendered HTML
    deactivate TPL
    
    FC-->>User: 200 OK (HTML Page)
    deactivate FC